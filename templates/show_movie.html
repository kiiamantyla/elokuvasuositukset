{% extends "layout.html" %}

{% block title %}{{ movie.title }}{% endblock %}


{% block content %}
<h2>{{ movie.title }}</h2>

{% if session.user_id == movie.user_id %}
<p>
  <a href="/edit_movie/{{ movie.id }}">Muokkaa</a>
  <a href="/remove_movie/{{ movie.id }}">Poista</a>
  <a href="/images/{{ movie.id }}">Kuvat</a>
</p>
{% endif %}

{% for poster in posters %}
  <img src="/poster/{{ poster.id }}"/>
{% endfor %}

<p>Julkaisuvuosi: {{ movie.year }}</p>
<p>Suosittelija: <a href="/user/{{ movie.user_id }}">{{ movie.username }}</a></p>
{% if genres %}
  <p>Genret:
    {% for genre in genres %}
      {{ genre.value }}{% if not loop.last %}, {% endif %}
    {% endfor %}
  </p>
{% endif %}
{% if age_limit %}
  <p>
    Ik채raja: {{ age_limit.value }}
  </p>
{% endif %}
<p>Arvosana: {{ movie.grade }}</p>
<p>Arvostelu: {{ movie.recommendation }}</p>

{% if images %}
  <p>Kuvia:</p>
  {% for image in images %}
    <img src="/image/{{ image.id }}"/>
  {% endfor %}
{% endif %}

<h3>Arvostelut</h3>
{% if reviews %}
  <ul>
    {% for review in reviews %}
    <li>{{ review.grade }}, {{ review.review }}<br />
    <a href="/user/{{ review.user_id }}">{{ review.username }}</a></li>
    {% endfor %}
  </ul>
{% else %}
  <p>Ei viel채 muita arvosteluja.</p>
{% endif %}

{% if session.user_id %}
  <h3>Uusi arvostelu</h3>
  <form action="/create_review" method="post">
    Arvostelu: <br />
      <textarea name="review" rows="8" cols="60" maxlength="500" required></textarea><br />
    Arvosana elokuvasta (1-10):
    <input type="text" name="grade" size="1" pattern="[1-9]|10" required /><br />
    <input type="hidden" name="movie_id" value="{{ movie.id }}" />
    <input type="submit" value="Lis채채 arvostelu">
  </form>
{% endif %}
{% endblock %}
